<% layout("/layouts/boilerplate") %>

    <body class="bg-light">
        <div class="container py-4">
            <h2 class="text-center mb-4">Listing Details</h2>
              <% if (success.length> 0) { %>
                        <div class="alert alert-success alert-dismissible fade show" role="alert">
                            <%= success %>
                                <button type="button" class="btn-close" data-bs-dismiss="alert"
                                    aria-label="Close"></button>
                        </div>
                        <% } %>

                            <% if (error.length> 0) { %>
                                <div class="alert alert-danger alert-dismissible fade show" role="alert">
                                    <%= error %>
                                        <button type="button" class="btn-close" data-bs-dismiss="alert"
                                            aria-label="Close"></button>
                                </div>
                                <% } %>
            <div class="row justify-content-center">
                <div class="col-12 col-md-10 col-lg-8">
                    <div class="card shadow-sm">
                        <img src="<%= list.image.url %>" style="max-height: 400px; object-fit: cover;"
                            class="card-img-top img-fluid" alt="<%= list.title %> Image">

                        <div class="card-body">
                            <h5 class="card-title">
                                <%= list.title %>
                            </h5>
                            <p class="card-text">
                                <%= list.description %>
                            </p>
                        </div>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item"><strong>Country:</strong>
                                <%= list.country %>
                            </li>
                            <li class="list-group-item"><strong>Location:</strong>
                                <%= list.location %>
                            </li>
                            <li class="list-group-item"><strong>Price:</strong> â‚¹<%= list.price ?
                                    list.price.toLocaleString('en-IN') : "N/A" %>
                            </li>
                        </ul>
                        <!-- Debug -->
                        <% if ( currentUser && currentUser.id && list.owner && list.owner._id &&
                            currentUser.id.toString()===list.owner._id.toString() ) { %>
                            <div class="card-body d-flex justify-content-between">
                                <a href="/listings/<%= list._id %>/edit" class="btn btn-warning btn-sm">Edit</a>
                                <form action="/listings/<%= list._id %>?_method=DELETE" method="POST"
                                    onsubmit="return confirm('Are you sure you want to delete this listing?');">
                                    <button class="btn btn-danger btn-sm">Delete</button>
                                </form>
                            </div>
                            <% } else { %>

                                <div class="card-body text-center">
                                    <a href="/listings/book/<%= list._id %>" class="btn btn-success btn-sm">Book Now</a>
                                </div>

                                <% } %>


                    </div>
                </div>
            </div>
        </div>
    </body>